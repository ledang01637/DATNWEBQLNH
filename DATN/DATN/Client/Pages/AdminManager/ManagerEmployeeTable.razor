@page "/manager"

@layout LayoutAdmin
@inject HttpClient httpClient
@inject IJSRuntime JS
@inject LocalStorageService _localStorageService
@inject NavigationManager Navigation
<style>
    #video-container {
        position: relative;
        margin: auto;
        width: 1px;
        height: 1px;
        overflow: hidden;
    }

    #localVideo {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 120px;
        height: 90px;
        z-index: 10;
        display: block;
        opacity: 1;
    }

    #remoteVideo {
        width: 100%;
        height: 100%;
        display: block;
        opacity: 1;
    }

    video {
        display: none;
    }


    #action-buttons {
        margin: auto;
        text-align: center;
        margin-top: 20px;
    }

    .box {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 250px;
        background-color: #333;
        border-radius: 10px;
        box-shadow: 0 4px 8px #333;
        z-index: 1000;
        padding: 10px;
        display: none;
        font-size: 10px !important;
    }

    #btn-end, #btn-answer, #btn-call, #btn-reject {
        width: 50px;
        height: 50px;
    }

    #btn-end {
        background-color: #dc3545;
        color: white;
        box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
    }

    #btn-answer {
        background-color: #28a745;
        color: white;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
    }

    #btn-reject {
        background-color: #643421;
        color: white;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
    }

    #btn-call {
        background-color: #45a14f;
        color: white;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
    }

    #btn-end:hover {
        background-color: #c82333;
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(220, 53, 69, 0.6);
        cursor: pointer;
    }

    #btn-answer:hover {
        background-color: #218838;
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.6);
        cursor: pointer;
    }

    #btn-reject:hover {
        background-color: #593421;
        transform: scale(1.1);
        box-shadow: 0 6px 20px #45a14f;
        cursor: pointer;
    }

    #btn-call:hover {
        background-color: #25a14f;
        color: white;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
    }

    #particles-js {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
    }
        body {
      font-family: 'Roboto', sans-serif;
      background-color: #f8f9fa;
      color: #333;
    }

    .container {
      max-width: 1200px;
    }
    .floor-section {
  margin-bottom: 50px;
  padding: 20px;
  border: 2px solid #dee2e6; /* Light gray border */
  border-radius: 12px;        /* Rounded corners */
  background-color: #fff;     /* White background for better contrast */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
}

    .header-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
    }

    .header-info h4 {
      font-weight: 500;
      margin: 0;
    }

    #clock {
      font-size: 1.3rem;
      font-weight: bold;
      color: #007bff;
    }

    h3, h5 {
      font-weight: 700;
      margin-bottom: 20px;
    }

    .table-container h5 {
      font-weight: 600;
      font-size: 1.25rem;
      margin-bottom: 15px;
    }

    .btn-table {
      height: 120px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 600;
      font-size: 1.1rem;
      text-transform: uppercase;
      background-size: 40px;
      background-position: center left 15px;
      background-repeat: no-repeat;
      padding-left: 60px;
      border-radius: 12px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .btn-table:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .btn-outline-secondary {
      background-color: #e9ecef;
      color: #6c757d;
    }

    .btn-outline-success {
      background-color: #d4edda;
      color: #155724;
    }

    .btn-outline-warning {
      background-color: #fff3cd;
      color: #856404;
    }

    .card {
      border: none;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .card-body {
      padding: 30px;
    }

    .list-group-item {
      font-weight: 500;
    }

    .list-group-item span {
      font-weight: bold;
    }

    .btn-success {
      font-size: 1.1rem;
      font-weight: 600;
      padding: 12px 0;
      border-radius: 8px;
      background-color: #28a745;
      border: none;
      transition: background-color 0.3s ease;
    }

    .btn-success:hover {
      background-color: #218838;
    }

    .modal-header {
      border-bottom: none;
    }

    .modal-footer {
      border-top: none;
    }

    .modal-footer .btn-primary {
      background-color: #007bff;
      border-radius: 8px;
    }

    .floor-section {
      margin-bottom: 50px;
    }

    .status-summary {
      margin-bottom: 40px;
    }

    .status-summary .badge {
      font-size: 1.2rem;
      padding: 10px 15px;
    }
</style>





<button class="btn btn-primary" @onclick="() => CallButton(false)">Gọi cho customer </button>


<div class="justify-content-center">
    <div class="card shadow-sm">
        <div class="row">
            <!-- Khu vực các bàn -->
            <div class="col-md-8 table-container">
                <h3 class="mb-4">Trạng thái bàn</h3>
                <div id="floor-1" class="floor-section">
                    <h5>Tầng 1</h5>
                    <div class="row" id="table-status-floor-1">
                        <!-- Bàn ở tầng 1 sẽ được thêm từ JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal để hiển thị chi tiết đơn hàng của bàn chờ xác nhận -->
<div class="modal fade" id="modalOrder" tabindex="-1" aria-labelledby="modalOrderLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalOrderLabel">Chi tiết đơn hàng - Bàn</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <ul id="modal-order-details" class="list-group mb-3">
                    <!-- Chi tiết đơn hàng sẽ được thêm từ JavaScript -->
                </ul>
                <div class="d-flex justify-content-between mb-3">
                    <span>Tổng cộng</span>
                    <strong id="modal-total-amount">$0.00</strong>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy bỏ</button>
                <button type="button" class="btn btn-primary">Xác nhận</button>
            </div>
        </div>
    </div>
</div>

<div class="box" id="call-box">
    <div id="particles-js"></div>
    <button @onclick="() => CallButton(true)" class="btn position-absolute top-0 start-0">
        <i class="far fa-window-close text-danger fs-4"></i>
    </button>
    <div class="caller-info">
        <div id="caller-name" class="caller-name text-center"></div>
    </div>
    <input id="toNumber" type="text" @bind-value="to" class="form-control bg-white text-dark" />
    <div id="video-container">
        <video id="localVideo" autoplay muted></video>
        <video id="remoteVideo" autoplay></video>
    </div>
    <div id="call-message" class="call-message text-center"></div>
    <div class="call-actions" id="call-actions">
        <button class="btn-action btn-end" id="btn-end">
            <i class="bi bi-telephone-x-fill" style="font-size: 10px;"></i>
            <span style="font-size: 10px">Kết thúc</span>
        </button>
        <button class="btn-action btn-answer" id="btn-answer">
            <i class="bi bi-telephone-fill" style="font-size: 10px;"></i>
            <span style="font-size: 10px">Nhận</span>
        </button>
        <button class="btn-action btn-reject" id="btn-reject">
            <i class="bi bi-telephone-down-fill" style="font-size: 10px;"></i>
            <span style="font-size: 10px">Từ chối</span>
        </button>
        <button class="btn-action btn-reject" id="btn-call">
            <i class="bi bi-telephone-down-fill" style="font-size: 10px;"></i>
            <span style="font-size: 10px">Gọi</span>
        </button>
    </div>
</div>

